---
title: Final_project:Creating a 3D Visualization for 938 unrelated individuals from
  the Human Genome Diversity Project.
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
genotypes<-read.table("/Users/bioinf/Desktop/Final_project/example/HGDP_238_chr22.geno",sep="\t", header=FALSE)
```

#sample2anc$superpopulation <- NA
```{r}
library(dplyr)
selectedgenotypes <- select(genotypes, V3:V201)
rownames(selectedgenotypes) <- genotypes$V2
sample2anc<-select(genotypes, V1:V2)
selectedgenotypes<- t(selectedgenotypes)
```

```{r}
principal_components <- prcomp(selectedgenotypes, center = TRUE,scale. = TRUE)
```

```{r}
plot(principal_components, type = "l")
```


```{r}
library(plotly)
pcadf<-data.frame(principal_components$rotation)
  plot_ly(data = pcadf, x = ~PC1, y = ~PC2, text = rownames(pcadf))
```

```{r}
population1 <-read.table("/Users/bioinf/Desktop/Final_project/for_dplyrnew.txt", sep="\t", header = FALSE)
```

```{r}
plot_ly(pcadf, x =~PC1, y = ~PC1, z = ~PC2,  color = samples$V1.y, colors = "Set1" ) %>%
 add_markers() %>%
 layout(scene = list(xaxis = list(title = 'PC1'),
 yaxis = list(title = 'PC2'),
 zaxis = list(title = 'PC3')))
```

```{r}
#selectedgenotypes$V2 <- rownames(selectedgenotypes)
#pcadf$V2 <- rownames(pcadf)
samples<- dplyr::left_join(sample2anc,population1, by="V2")
```

